# address_book
Адресная книга работающая через redis

### Согласно ТЗ реализованы 3 апишки:
для записи адреса и хранения и получения используется редис

- 1. POST `/write_data/` - Записывает в редис значения телефона и адреса. Тело запроса:
```
{
  "address": "Адрес",
  "phone": "89999999999"
}
```
- 2. PUT `/write_data/` - Изменяет значение адреса в редисе по номеру телефона. Тело запроса:
```
{
  "address": "Адрес",
  "phone": "89999999999"
}
```
- 3. GET `/check_data/?phone=89999999999` - Получает адрес по номеру телефона. 
```
"address": "Адрес"
```
Если адреcа нет, то выводит сообщение:
```
{
    "message": "По данному номеру не зарегистрировано адреса"
}
```

## Запуск проекта через docker-compose
Для запуска проекта необходимо перейти в папку `address_book` и выполнить команду 
`docker-compose up --build -d && docker-compose logs -f web`

После запуска можно проверять работу апишек


# Второе задание

Создал 2 таблицы с данными из условия

## Решение
Решение заключается в том, задать индексы на поля учавствующие в сравнении и сравнивании двух таблиц по условию: название 1 таблицы = названию 2 таблицы при отрезании всего что начинается с точки.

См изображение наполнение БД
![Наполнение БД](./Наполнение%20БД.png)

Выполнил скрипт на обновление данных
Время выполнения скрипта 5 сек
![Время выполнения](./Скрипт%20и%20время%20выполнения.png)

Сам скрипт в файлe script.sql

И приложен ниже
```
-- Начало транзакции
BEGIN;

-- Создание вспомогательной таблицы с базовыми именами и статусами из plans_shortname
CREATE TABLE IF NOT EXISTS shortname_base1 AS
SELECT name AS base_name, 
       status
FROM plans_shortname;

-- Создание индекса на вспомогательной таблице для ускорения поиска
CREATE INDEX IF NOT EXISTS idx_base_name ON shortname_base1 (base_name);

-- Обновление статусов в plans_fullname на основе данных из shortname_base1
UPDATE plans_fullname fn
SET status = sb.status
FROM shortname_base1 sb
WHERE LEFT(fn.full_name, LENGTH(fn.full_name) - POSITION('.' IN REVERSE(fn.full_name))) = sb.base_name
  AND fn.status IS NULL;

-- Завершение транзакции
COMMIT;
```